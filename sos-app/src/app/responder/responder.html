<div class="admin-container">
	<!-- Login Form -->
	<div *ngIf="!isLoggedIn" class="login-form">
		<h2>Admin Login</h2>
		<form (ngSubmit)="login()">
			<label for="username">Username:</label>
			<input id="username" [(ngModel)]="username" name="username" required>
			<label for="password">Password:</label>
			<input id="password" type="password" [(ngModel)]="password" name="password" required>
			<button type="submit">Login</button>
			<div class="error" *ngIf="loginError">{{ loginError }}</div>
		</form>
	</div>

	<!-- Admin Controls & Map -->
	<div *ngIf="isLoggedIn" class="admin-panel">
		<div class="controls">
			<button (click)="refreshAlerts()">Refresh Alerts</button>
			<button (click)="logout()">Logout</button>
		</div>
		<div class="alerts-list">
			<h3>SOS Alerts</h3>
			<div class="alerts-controls">
				<label>
					Filter:
					<select [(ngModel)]="filterStatus" (change)="applyFilterAndSort()">
						<option value="active">Active</option>
						<option value="all">All</option>
					</select>
				</label>
				<button (click)="toggleSortOrder()">Sort by Time {{ sortOrder === 'asc' ? '↑' : '↓' }}</button>
			</div>
			<div class="alerts-card">
				<table class="alerts-table">
					<thead>
						<tr>
							<th>ID</th>
							<th>Latitude</th>
							<th>Longitude</th>
							<th (click)="toggleSortOrder()" style="cursor:pointer">Timestamp {{ sortOrder === 'asc' ? '↑' : '↓' }}</th>
							<th>Status</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let alert of displayedAlerts">
							<td>{{ alert.id }}</td>
							<td>{{ alert.lat }}</td>
							<td>{{ alert.lon }}</td>
							<td>{{ alert.timestamp | date:'short' }}</td>
							<td>{{ alert.status || 'active' }}</td>
						</tr>
					</tbody>
				</table>
				<div *ngIf="displayedAlerts.length === 0" class="no-alerts">No alerts found.</div>
			</div>
		</div>
		<div class="map-container">
			<div id="map"></div>
		</div>
	</div>
</div>
